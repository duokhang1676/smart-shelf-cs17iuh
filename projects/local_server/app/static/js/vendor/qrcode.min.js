/*
* Copyright 2025 Tran Vu Thuy Trang [C]
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
// Simple QR Code Generator for local use
// Fallback to API-based QR generation
window.QRCode = {
    toCanvas: function(container, text, options, callback) {
        try {
            // Create canvas element
            const canvas = document.createElement('canvas');
            canvas.width = options.width || 256;
            canvas.height = options.height || 256;
            
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${canvas.width}x${canvas.height}&data=${encodeURIComponent(text)}`;
            
            const img = new Image();
            img.onload = function() {
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                container.appendChild(canvas);
                if (callback) callback(null);
            };
            img.onerror = function() {
                if (callback) callback(new Error('Failed to generate QR code'));
            };
            img.src = qrUrl;
            
        } catch (error) {
            if (callback) callback(error);
        }
    }
};